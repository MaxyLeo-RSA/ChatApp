name: Java Tests

on:
  push:
    branches: [ main, master, develop ]
  pull_request:
    branches: [ main, master ]

jobs:
  test:
    name: Run QuickChat Tests
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“¥ Checkout code
      uses: actions/checkout@v4
      
    - name: â˜• Set up JDK 11
      uses: actions/setup-java@v4
      with:
        java-version: '11'
        distribution: 'temurin'
        
    - name: ğŸ” Check Java files
      run: |
        echo "Java files found:"
        find . -name "*.java" -type f | head -10
        echo "Total Java files: $(find . -name "*.java" -type f | wc -l)"
        
    - name: ğŸ“ Create directory structure
      run: |
        mkdir -p build
        # Move all Java files to proper structure if needed
        if [ ! -d "src/chatapp" ]; then
          mkdir -p src/chatapp
          find . -maxdepth 1 -name "*.java" -exec mv {} src/chatapp/ \; 2>/dev/null || true
        fi
        
    - name: ğŸ—ï¸ Compile Java source
      run: |
        echo "Compiling Java files..."
        javac -d build src/chatapp/*.java
        echo "Compilation completed successfully!"
        
    - name: ğŸ§ª Run Automated Tests
      run: |
        echo "Running test suite..."
        java -cp build chatapp.TestRunner
        echo "Tests completed!"
        
    - name: ğŸ“Š Test Results
      if: always()
      run: |
        echo "=== TEST EXECUTION COMPLETE ==="
        echo "View the logs above for detailed results"
